{% extends "cantina/base.html" %}

{% block title %}{{ customer.first_name }} {{ customer.last_name }}{% endblock %}

{% block header %}
  <h1>{{ customer.first_name }} {{ customer.last_name }}</h1>
{% endblock %}

{% block content %}
  <p>
    Planet: {{ customer.planet }}<br>
    {% if customer.uba %}
      UBA: {{ customer.uba }}<br>
    {% endif %}
    <a href="{% url 'cantina:edit_customer' customer.id %}">Edit</a>
    <a href="{% url 'cantina:delete_customer' customer.id %}">Delete</a>
  </p>
  {% if customer.tab_set.all %}
    <h2>Purchase History:</h2>
    <table>
      <thead>
        <th>Tab #</th>
        <th>Opened</th>
        <th>Closed</th>
        <th>Due</th>
      </thead>
      <tbody>
        {% for tab in customer.tab_set.all %}
          <tr>
            <td>
              <a href="{% url 'cantina:tab' tab.id %}">{{ tab.id }}</a>
            </td>
            <td>{{ tab.opened|date:"Y-m-d H:i" }}</td>
            <td>{{ tab.closed|date:"Y-m-d H:i" }}</td>
            {% if not tab.closed %}
              <td>{{ tab.due|date:"Y-m-d H:i" }}</td>
            {% endif %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
{% endblock %}
